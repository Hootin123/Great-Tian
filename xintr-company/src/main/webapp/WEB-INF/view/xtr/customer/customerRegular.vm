##员工转正
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>转正</title>
    #parse("comm/head.vm")
    <link rel="stylesheet" type="text/css" href="#springUrl('/resource/css/customer/customerRegular.css')"/>
    <link rel="stylesheet" type="text/css" href="#springUrl('/resource/js/plugins/laydate/need/laydate.css')"/>
    <script src="#springUrl('/resource/js/plugins/laydate/laydate.js')"></script>
    <script src="#springUrl('/resource/js/comm/validateUtil.js')"></script>
</head>
<body>
<div class="header">
    <h2 class='title1'><span>$!{trueName}</span><b>&nbsp;—&nbsp;</b>转正</h2>
    <img src="#springUrl('/resource/img/salary/guanbi.png')" alt="" id="closeDetailBtn">
</div>
<form id="regularForm">
<section>
     <input type="hidden" name="customerId"  id="customerId" value="$!{customerId}">
    <input type="hidden" name="isRegular" id="isRegular"  value="$!{isRegular}"/>


    <div class="top">备注 ：转正后，如果有员工有调薪请手动操作</div>
    <div class="cont">
        <ul class='left'>
            <li>
                <span>*</span>入职时间
            </li>
            <li>
                <span>*</span>转正时间
            </li>
            <li>
                <span> </span>转正评价
            </li>
        </ul>
        <ul class='right'>
            <li>
               $!date.format( 'yyyy-MM-dd',$!{stationEnterTime})
            </li>
            <!-- 转正日期-->
            <li>
                <input type="text" name="stationRegularTime"   value="$!date.format('yyyy-MM-dd',$!{stationRegularTime})" readonly="readonly" id="stationRegularTime" class="laydate-icon"  style="width: 250px;" onclick="laydate()" />
                &nbsp;&nbsp;<span id="regularMsg" style="color: red;display: none">已转正</span>
            </li>
            <!-- 转正评价-->
            <li class='txtarea'>
                <textarea cols=40 rows=3 placeholder="0-300个字符" name="stationRegularEvaluate" id="stationRegularEvaluate"></textarea>
            </li>
        </ul>
    </div>

</section>
</form>
<footer>
    <div class="bottom">
        <div class="bottomBtn">
            <input type="button" name=""  id="updateBtn" value='更新设置'>
            <input type="button" name="" class='btnClose' value='取消'>
        </div>
    </div>
</footer>
<script type="text/javascript">

    //初始化
    $(function(){
        //取消
        $('#closeDetailBtn').click(function(){
            onCancelDialog()
        })
        function onCancelDialog() {
            var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
            parent.layer.close(index);
        }

      var regularVal = $("#isRegular").val();
       if(regularVal==2){
           $("#regularMsg").show();
           $("#stationRegularTime").attr('disabled',true);
       }
    });
    $(".title1 em").on('click',function(){
        $('#regular-content').hide();
        $('.mengban2').hide()
        $('.regular').show()
    })

    //关闭按钮
    $(".btnClose").click(function(){
        var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
        parent.layer.close(index);
    })

    //点击更新设置
    $("#updateBtn").click(function(){
       var stationRegularTimeValue = $("#stationRegularTime").val();
       var isRegular =  $("#isRegular").val();
       if((stationRegularTimeValue==null||stationRegularTimeValue=="")&&isRegular!=2){
           alert("转正日期不能为空值");
           return false;
       }

        $.ajax({
            type:'POST',
            url:'customerRegular.htm',
            data:$("#regularForm").serialize(),
            dataType:'json',
            success:function(resultResponse){
                if(resultResponse.success){
                    layer.alert('操作成功',{
                        title:'处理结果',
                    },function(index){
                        parent.loadCustomerList();
                        var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
                        parent.layer.close(index);
                    });

                }else{
                    layer.alert(resultResponse.message);
                }
            },
            error:function(){
                layer.alert("网络错误");
            }


        }) ;



    });


</script>
</body>
</html>