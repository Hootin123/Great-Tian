<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
        "http://www.w3.org/TR/html4/strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title></title>
    #parse("comm/head.vm")
    <link href="#springUrl('/resource/css/comm/comm.css')" rel="stylesheet">
    <link href="#springUrl('/resource/css/account/kkpager_orange.css')" rel="stylesheet">
    <link href="#springUrl('/resource/css/account/account.css')" rel="stylesheet">
    <script src="#springUrl('/resource/js/payday/jquery-1.11.0.min.js')"></script>
    <script src="#springUrl('/resource/js/payday/kkpager.min.js')"></script>
    <script>
      function showBorrow(){
        var sum=$!{sum};
        if(sum=="1"){
           window.location.href = 'paysecurity.htm';
        }
      }
    </script>
    <style>
     html,body{width:100%;}
    .top{width:100%;height:80px;border-bottom:1px solid #dbe9ee;min-width:1000px;}
    .top h2{text-align: center;padding-top:30px;}
    .top a{width:100px;height:40px;background:#0696fa;float: right;line-height:40px;text-align: center;border-radius:6px;font-size:16px;color:#fff;margin:40px 5%  0 0; }
    .con{width:90%;height:500px;margin:0 auto;}
    .sheet{margin:0 auto;min-width:1000px;margin-top:100px;width:100%; font-size: 12px;color: #333;}
    .sheet td{border:1px solid #b8dae6;height:50px;text-align: center;}
    .line1{background: #f1f8fe; color: #333;font-weight: 600;}
    .first_last:nth-child(odd){background: #feebe7;}


    </style>
</head>

<body onload="showBorrow()">
<div class="top">
<h2>垫付操作记录</h2>
#if($!{companyProtocolsSum} == "1")
<a href="applypayfor.htm">申请垫付</a>
#else
服务已过期，请联系：400-175-8090，重新签约
#end
</div>
<div class="con">

<table class="sheet">
<tr class="line1">
<td>垫付订单号</td>
<td>申请时间</td>
<td>到期时间</td>
<td>垫付金额</td>
<td>垫付期限</td>
<td>还款方式</td>
<td>计息方式</td><td class="row8">利率</td>
<td>服务费</td>
<td>状态/操作</td>
</tr>
 #if($!{ordersData} && $!{ordersData.size()} > 0)
    #foreach($data in $!{ordersData})
    <tr class="first_last">
    <td>$!{data.orderNumber}</td>
    <td>$!date.format('yyyy.MM.dd',$!{data.orderAddtime})</td>
    <td>
        $!date.format('yyyy.MM.dd',$!{data.orderExpireTime})
        </td>
    <td>$!{data.orderMoney}</td>
    <td>
     #if($!{data.orderInterestType} == '1')
    $!{data.orderInterestCycle} 天
    #elseif($!{data.orderInterestType} == '2')
    $!{data.orderInterestCycle}个月
    #else
      暂无
    #end
    </td>
    <td>
     #if( $!{data.orderRepayType}=='1')
    一次性还本付息
    #elseif($!{data.orderRepayType}=='2')
    一次性还本按月付息
    #elseif($!{data.orderRepayType}=='3')
    一次性还本按天付息
    #elseif($!{data.orderRepayType}=='4')
    按月分期还本付息
    #elseif($!{data.orderRepayType}=='5')
    按天还本分期付息
    #else
      暂无
    #end
    </td>
    <td>
     #if($!{data.orderInterestType}=='1')
    按天
    #elseif($!{data.orderInterestType}=='2')
    按月
    #else
    暂无
    #end
    </td>
    <td>$!{data.orderRate}%</td>
    <td>$!{data.orderActualServer}</td>
        <td>
             #if($!{data.orderState} == '0')
     申请中 / <a style="color:#0696fa;cursor:pointer;"  onclick="borrowUpdate($!{data.orderId},1)">撤销</a>
    #elseif($!{data.orderState} == '1')
     已撤销
    #elseif($!{data.orderState} == '2')
      <a style="cursor:pointer" title="$!{data.orderAuditRemark}">已驳回</a>
    #elseif($!{data.orderState} == '6')
     已放款
     #elseif($!{data.orderState} == '3')
     已处理
     #elseif($!{data.orderState} == '4')
     融资失败
     #elseif($!{data.orderState} == '5')
      待出款
             #end
        </td>
</tr>
#end
#end
</table>
<div id="kkpager" style=""></div>
</div>
<div class="pacity" style="display:none; width:100%;height:100%;opacity:0.7;background:#000; position: absolute;left: 0;top: 0; filter:alpha(opacity=70);"></div>
<div style="display:none;" class="aboxbg" id="aboxbg">
<div class="abox" id="abox">
<div class="abox_head">
<span>撤销垫付申请</span>
</div>
<p style='padding:0 40px;'>您好，确定撤销后我们将不会在此跟进申请，如果后期有垫付需求，需要重新再申请</p>
<i style="width:200px;height:40px;float:left;margin-left:80px;">确认</i>
<i style="width:100px;height:40px;float:left;border:1px solid #0696fa;background:#fff;color:#0696fa;margin-left:20px;">取消</i>
</div>
</div>
</body>
<script type="text/javascript">
//生成分页控件
kkpager.generPageHtml({
        pno: '$!{paginator.page}',
        mode: 'link', //可选，默认就是link
        //总页码
        total: '$!{paginator.totalPages} ',
        //总数据条数
        totalRecords: '$!{paginator.totalCount} ',
        //链接前部
        hrefFormer: '${hrefFormer}',
        //链接尾部
        hrefLatter: '${hrefLatter}',
        //链接算法
        isShowFirstPageBtn:false,
        isShowLastPageBtn:false,
        currPageBeforeText:'第',

        getLink: function (n) {
return 'paysecurity.htm?pageIndex=' + n;
}
});

function borrowUpdate(orderId,orderState){
    $.ajax({
    type:"POST",
    url:"borrowInfoupdate.htm?orderId="+orderId+"&orderState="+orderState,
    dataType:"json",
    async: true,
    success: function(data){
    if (data.success) {
      alert('撤回成功！')
      window.location.reload();
    }
    }
    });
}
</script>
</html>