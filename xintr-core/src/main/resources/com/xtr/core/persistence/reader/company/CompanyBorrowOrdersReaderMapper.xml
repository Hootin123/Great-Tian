<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xtr.core.persistence.reader.company.CompanyBorrowOrdersReaderMapper" >
  <resultMap id="BaseResultMap" type="com.xtr.api.domain.company.CompanyBorrowOrdersBean" >
    <!--BaseResultMap
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="order_id" property="orderId" jdbcType="BIGINT" />
    <result column="order_company_id" property="orderCompanyId" jdbcType="BIGINT" />
    <result column="order_dep_id" property="orderDepId" jdbcType="BIGINT" />
    <result column="order_money" property="orderMoney" jdbcType="DECIMAL" />
    <result column="order_addtime" property="orderAddtime" jdbcType="TIMESTAMP" />
    <result column="order_number" property="orderNumber" jdbcType="VARCHAR" />
    <result column="order_state" property="orderState" jdbcType="INTEGER" />
    <result column="order_canceltime" property="orderCanceltime" jdbcType="TIMESTAMP" />
    <result column="order_audittime" property="orderAudittime" jdbcType="TIMESTAMP" />
    <result column="order_lendtime" property="orderLendtime" jdbcType="TIMESTAMP" />
    <result column="order_sign" property="orderSign" jdbcType="INTEGER" />
    <result column="order_edit_member" property="orderEditMember" jdbcType="BIGINT" />
    <result column="order_edit_time" property="orderEditTime" jdbcType="TIMESTAMP" />
    <result column="order_interest_type" property="orderInterestType" jdbcType="INTEGER" />
    <result column="order_interest_cycle" property="orderInterestCycle" jdbcType="INTEGER" />
    <result column="order_repay_type" property="orderRepayType" jdbcType="INTEGER" />
    <result column="order_repay_starttime" property="orderRepayStarttime" jdbcType="TIMESTAMP" />
    <result column="order_repay_endtime" property="orderRepayEndtime" jdbcType="TIMESTAMP" />
    <result column="order_cycle" property="orderCycle" jdbcType="INTEGER" />
    <result column="order_cycle_unit" property="orderCycleUnit" jdbcType="INTEGER" />
    <result column="order_rate" property="orderRate" jdbcType="DECIMAL" />
    <result column="order_prop_id" property="orderPropId" jdbcType="INTEGER" />
    <result column="order_prop_coupon_type" property="orderPropCouponType" jdbcType="INTEGER" />
    <result column="order_prop_coupon_value" property="orderPropCouponValue" jdbcType="DECIMAL" />
    <result column="order_money_arrival" property="orderMoneyArrival" jdbcType="DECIMAL" />
    <result column="order_actual_money" property="orderActualMoney" jdbcType="DECIMAL" />
    <result column="order_actual_rate" property="orderActualRate" jdbcType="DECIMAL" />
    <result column="order_actual_server_rate" property="orderActualServerRate" jdbcType="DECIMAL" />
    <result column="order_actual_deposit_rate" property="orderActualDepositRate" jdbcType="DECIMAL" />
    <result column="order_actual_server" property="orderActualServer" jdbcType="DECIMAL" />
    <result column="order_actual_deposit" property="orderActualDeposit" jdbcType="DECIMAL" />
    <result column="order_repay_overtime" property="orderRepayOvertime" jdbcType="TIMESTAMP" />
    <result column="order_type" property="orderType" jdbcType="INTEGER" />
    <result column="order_borrowpercent" property="orderBorrowpercent" jdbcType="DECIMAL" />
    <result column="order_salaryall" property="orderSalaryall" jdbcType="DECIMAL" />
    <result column="order_applytime" property="orderApplytime" jdbcType="DATE" />
    <result column="order_salary_day" property="orderSalaryDay" jdbcType="DATE" />
    <result column="order_appoint_remittance_date" property="orderAppointRemittanceDate" jdbcType="DATE" />
    <result column="order_remittance_time" property="orderRemittanceTime" jdbcType="TIMESTAMP" />
    <result column="order_cancel_remark" property="orderCancelRemark" jdbcType="VARCHAR" />
    <result column="order_audit_remark" property="orderAuditRemark" jdbcType="VARCHAR" />
    <result column="order_finance_resion" property="orderFinanceResion" jdbcType="VARCHAR" />
    <result column="order_expect_day" property="orderExpectDay" jdbcType="DATE" />

      <result column="order_audit_user" property="orderAuditUser" jdbcType="VARCHAR" />
      <result column="order_finance_user" property="orderFinanceUser" jdbcType="VARCHAR" />
      <result column="order_lend_user" property="orderLendUser" jdbcType="VARCHAR" />
      <result column="order_finance_time" property="orderFinanceTime" jdbcType="TIMESTAMP" />
      <result column="order_expire_time" property="orderExpireTime" jdbcType="TIMESTAMP" />
  </resultMap>



    <resultMap id="BaseResultBorrowInfoMap" type="com.xtr.api.domain.company.BorrowInfoBean" >
        <!--BaseResultMap
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="borrow_order_number" property="borrowOrderNumber" jdbcType="VARCHAR" />
        <result column="borrow_bank_name" property="borrowBankName" jdbcType="VARCHAR" />
        <result column="borrow_bank_no" property="borrowBankNo" jdbcType="VARCHAR" />
        <result column="borrow_serial_number" property="borrowSerialNumber" jdbcType="VARCHAR" />
        <result column="borrow_account_money" property="borrowAccountMoney" jdbcType="DECIMAL" />
        <result column="borrow_remark" property="borrowRemark" jdbcType="VARCHAR" />
        <result column="borrow_addtime" property="borrowAddtime" jdbcType="TIMESTAMP" />
    </resultMap>
  <sql id="Base_Column_List" >
    order_id, order_company_id, order_dep_id, order_money, order_addtime, order_number, 
    order_state, order_canceltime, order_audittime, order_lendtime, order_sign, order_edit_member, 
    order_edit_time, order_interest_type, order_interest_cycle, order_repay_type, order_repay_starttime, 
    order_repay_endtime, order_cycle, order_cycle_unit, order_rate, order_prop_id, order_prop_coupon_type, 
    order_prop_coupon_value, order_money_arrival, order_actual_money, order_actual_rate, 
    order_actual_server_rate, order_actual_deposit_rate, order_actual_server, order_actual_deposit, 
    order_repay_overtime, order_type, order_borrowpercent, order_salaryall, order_applytime, 
    order_salary_day, order_appoint_remittance_date, order_remittance_time, order_cancel_remark, 
    order_audit_remark, order_finance_resion, order_expect_day,order_audit_user,order_finance_user,order_lend_user,order_finance_time,order_expire_time
  </sql>
    <sql id="Base_Column_List2" >
        order_id, order_company_id, order_dep_id, order_money, order_addtime, order_number,
        order_state, order_canceltime, order_audittime, order_lendtime, order_sign, order_edit_member,
        order_edit_time, order_interest_type, order_interest_cycle, order_repay_type, order_repay_starttime,
        order_repay_endtime, order_cycle, order_cycle_unit, order_rate, order_prop_id, order_prop_coupon_type,
        order_prop_coupon_value, order_money_arrival, order_actual_money, order_actual_rate,
        order_actual_server_rate, order_actual_deposit_rate, order_actual_server, order_actual_deposit,
        order_repay_overtime, order_type, order_borrowpercent, order_salaryall, order_applytime,
        order_salary_day, order_appoint_remittance_date, order_remittance_time, order_cancel_remark,
        order_audit_remark, order_finance_resion, order_expect_day,order_finance_time,
        order_expire_time
    </sql>
    <sql id="BorrowInfo_Column_List" >
        id, borrow_order_number, borrow_bank_name, borrow_bank_no, borrow_serial_number, borrow_account_money,borrow_remark,
        borrow_addtime
    </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select 
    <include refid="Base_Column_List" />
    from company_borrow_orders
    where order_id = #{orderId,jdbcType=BIGINT}
  </select>

    <sql id="Example_Where_Clause">
        <where>
            <trim prefix="AND" suffixOverrides=",">
                <if test="orderCompanyId != null">
                    order_company_id = #{orderCompanyId,jdbcType=BIGINT},
                </if>
                <if test="orderDepId != null">
                    order_dep_id = #{orderDepId,jdbcType=BIGINT},
                </if>
                <if test="orderMoney != null">
                    order_money = #{orderMoney,jdbcType=DECIMAL},
                </if>
                <if test="orderAddtime != null">
                    order_addtime = #{orderAddtime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderNumber != null">
                    order_number = #{orderNumber,jdbcType=VARCHAR},
                </if>
                <if test="orderState != null">
                    order_state = #{orderState,jdbcType=INTEGER},
                </if>
                <if test="orderCanceltime != null">
                    order_canceltime = #{orderCanceltime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderAudittime != null">
                    order_audittime = #{orderAudittime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderLendtime != null">
                    order_lendtime = #{orderLendtime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderSign != null">
                    order_sign = #{orderSign,jdbcType=INTEGER},
                </if>
                <if test="orderEditMember != null">
                    order_edit_member = #{orderEditMember,jdbcType=BIGINT},
                </if>
                <if test="orderEditTime != null">
                    order_edit_time = #{orderEditTime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderInterestType != null">
                    order_interest_type = #{orderInterestType,jdbcType=INTEGER},
                </if>
                <if test="orderInterestCycle != null">
                    order_interest_cycle = #{orderInterestCycle,jdbcType=INTEGER},
                </if>
                <if test="orderRepayType != null">
                    order_repay_type = #{orderRepayType,jdbcType=INTEGER},
                </if>
                <if test="orderRepayStarttime != null">
                    order_repay_starttime = #{orderRepayStarttime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderRepayEndtime != null">
                    order_repay_endtime = #{orderRepayEndtime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderCycle != null">
                    order_cycle = #{orderCycle,jdbcType=INTEGER},
                </if>
                <if test="orderCycleUnit != null">
                    order_cycle_unit = #{orderCycleUnit,jdbcType=INTEGER},
                </if>
                <if test="orderRate != null">
                    order_rate = #{orderRate,jdbcType=DECIMAL},
                </if>
                <if test="orderPropId != null">
                    order_prop_id = #{orderPropId,jdbcType=INTEGER},
                </if>
                <if test="orderPropCouponType != null">
                    order_prop_coupon_type = #{orderPropCouponType,jdbcType=INTEGER},
                </if>
                <if test="orderPropCouponValue != null">
                    order_prop_coupon_value = #{orderPropCouponValue,jdbcType=DECIMAL},
                </if>
                <if test="orderMoneyArrival != null">
                    order_money_arrival = #{orderMoneyArrival,jdbcType=DECIMAL},
                </if>
                <if test="orderActualMoney != null">
                    order_actual_money = #{orderActualMoney,jdbcType=DECIMAL},
                </if>
                <if test="orderActualRate != null">
                    order_actual_rate = #{orderActualRate,jdbcType=DECIMAL},
                </if>
                <if test="orderActualServerRate != null">
                    order_actual_server_rate = #{orderActualServerRate,jdbcType=DECIMAL},
                </if>
                <if test="orderActualDepositRate != null">
                    order_actual_deposit_rate = #{orderActualDepositRate,jdbcType=DECIMAL},
                </if>
                <if test="orderActualServer != null">
                    order_actual_server = #{orderActualServer,jdbcType=DECIMAL},
                </if>
                <if test="orderActualDeposit != null">
                    order_actual_deposit = #{orderActualDeposit,jdbcType=DECIMAL},
                </if>
                <if test="orderRepayOvertime != null">
                    order_repay_overtime = #{orderRepayOvertime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderType != null">
                    order_type = #{orderType,jdbcType=INTEGER},
                </if>
                <if test="orderBorrowpercent != null">
                    order_borrowpercent = #{orderBorrowpercent,jdbcType=DECIMAL},
                </if>
                <if test="orderSalaryall != null">
                    order_salaryall = #{orderSalaryall,jdbcType=DECIMAL},
                </if>
                <if test="orderApplytime != null">
                    order_applytime = #{orderApplytime,jdbcType=DATE},
                </if>
                <if test="orderSalaryDay != null">
                    order_salary_day = #{orderSalaryDay,jdbcType=DATE},
                </if>
                <if test="orderAppointRemittanceDate != null">
                    order_appoint_remittance_date = #{orderAppointRemittanceDate,jdbcType=DATE},
                </if>
                <if test="orderRemittanceTime != null">
                    order_remittance_time = #{orderRemittanceTime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderCancelRemark != null">
                    order_cancel_remark = #{orderCancelRemark,jdbcType=VARCHAR},
                </if>
                <if test="orderAuditRemark != null">
                    order_audit_remark = #{orderAuditRemark,jdbcType=VARCHAR},
                </if>
                <if test="orderFinanceResion != null">
                    order_finance_resion = #{orderFinanceResion,jdbcType=VARCHAR},
                </if>

                <if test="orderAuditUser != null">
                    order_audit_user = #{orderAuditUser,jdbcType=VARCHAR},
                </if>
                <if test="orderFinanceUser != null">
                    order_finance_user = #{orderFinanceUser,jdbcType=VARCHAR},
                </if>
                <if test="orderLendUser != null">
                    order_lend_user = #{orderLendUser,jdbcType=VARCHAR},
                </if>
                <if test="orderFinanceTime != null">
                    order_finance_time = #{orderFinanceTime,jdbcType=TIMESTAMP},
                </if>
                <if test="orderExpireTime != null" >
                    order_expire_time = #{orderExpireTime,jdbcType=TIMESTAMP},
                </if>
            </trim>
        </where>
    </sql>
  
  <sql id="borrow_info_Where_Clause">
      <where>
      <trim prefix="AND" suffixOverrides=",">
          <if test="id != null">
              id = #{id,jdbcType=BIGINT},
          </if>
          <if test="borrowOrderNumber != null">
              borrow_order_number = #{borrowOrderNumber,jdbcType=VARCHAR},
          </if>
          <if test="borrowBankName != null">
              borrow_bank_name = #{borrowBankName,jdbcType=VARCHAR},
          </if>
          <if test="borrowBankNo != null">
              borrow_bank_no = #{borrowBankNo,jdbcType=VARCHAR},
          </if>
          <if test="borrowSerialNumber != null">
              borrow_serial_number = #{borrowSerialNumber,jdbcType=VARCHAR},
          </if>
          <if test="borrowAccountMoney != null">
              borrow_account_money = #{borrowAccountMoney,jdbcType=DECIMAL},
          </if>
          <if test="borrowRemark != null">
              borrow_remark = #{borrowRemark,jdbcType=VARCHAR},
          </if>
          <if test="borrowAddtime != null">
              borrow_addtime = #{borrowAddtime,jdbcType=TIMESTAMP},
          </if>
      </trim>
      </where>
  </sql>

  <!-- 分页查询 -->
  <select id="selectPageList" resultMap="BaseResultMap" parameterType="com.xtr.api.domain.company.CompanyBorrowOrdersBean">
        SELECT
        <include refid="Base_Column_List"/>,
      order_audit_user as order_audit_user2,order_finance_user as order_finance_user2,order_lend_user as order_lend_user2
        FROM company_borrow_orders
        <include refid="Example_Where_Clause"/>
        ORDER BY order_addtime DESC
   </select>

    <!-- 分页查询企业流水 -->
    <select id="selectPageBorrowOrdersList" resultMap="BaseResultMap" parameterType="com.xtr.api.domain.company.CompanyBorrowOrdersBean">
        SELECT
        <include refid="Base_Column_List2"/>,b.company_name as companyName,b.company_contact_tel as companyContactTel,
        CONCAT(c.user_name,'(',c.id,')') as order_audit_user,CONCAT(d.user_name,'(',d.id,')') as order_finance_user,CONCAT(e.user_name,'(',e.id,')') as order_lend_user
        from company_borrow_orders as a
        left join companys as b on a.order_company_id = b.company_id
        left join sys_user as c on a.order_audit_user = c.id
        left join sys_user as d on a.order_finance_user = d.id
        left join sys_user as e on a.order_lend_user = e.id
        WHERE 1=1
        <if test="orderState != null">
            AND a.order_state = #{orderState,jdbcType=INTEGER}
        </if>
        <if test="companyName != null">
            AND (b.company_name like '%${companyName}%' OR b.company_contact_tel like '%${companyName}%')
        </if>
        ORDER BY a.order_addtime DESC
    </select>

    <!-- 查询借款信息表 -->
    <select id="selectBorrowInfoBeanList" resultMap="BaseResultBorrowInfoMap" parameterType="com.xtr.api.domain.company.BorrowInfoBean">
        SELECT
        <include refid="BorrowInfo_Column_List"/>
        FROM borrow_info
        <include refid="borrow_info_Where_Clause"/>
    </select>
    <select id="selectByOrderNumber" resultMap="BaseResultMap">
        select <include refid="Base_Column_List"/> from company_borrow_orders where order_number = #{orderNumber}

    </select>

</mapper>