<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xtr.core.persistence.writer.company.CompanySalaryExcelWriterMapper">

    <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        delete from company_salary_excel
        where excel_id = #{excelId,jdbcType=BIGINT}
    </delete>

    <delete id="deleteByCompanyId" parameterType="java.lang.Long">
        delete from company_salary_excel
        where excel_company_id = #{companyId,jdbcType=BIGINT}
    </delete>
    <insert id="insert" parameterType="com.xtr.api.domain.company.CompanySalaryExcelBean"  useGeneratedKeys="true" keyProperty="excelId">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into company_salary_excel (excel_id, excel_company_id, excel_dep_id,
        excel_year, excel_month, excel_name,
        excel_addtime, excel_state, excel_path,
        excel_addmember, excel_salary_total, excel_cost_total,
        excel_audit_time_first, excel_audit_member_first,
        excel_audit_remark_first, excel_audit_time_second,
        excel_audit_member_second, excel_audit_remark_second,
        excel_audit_time_third, excel_audit_member_third,
        excel_audit_remark_third,excel_grant_state,excel_payday,
        excel_payroll_number,excel_group_name)
        values (#{excelId,jdbcType=BIGINT}, #{excelCompanyId,jdbcType=BIGINT}, #{excelDepId,jdbcType=BIGINT},
        #{excelYear,jdbcType=INTEGER}, #{excelMonth,jdbcType=INTEGER}, #{excelName,jdbcType=VARCHAR},
        #{excelAddtime,jdbcType=TIMESTAMP}, #{excelState,jdbcType=INTEGER}, #{excelPath,jdbcType=VARCHAR},
        #{excelAddmember,jdbcType=BIGINT}, #{excelSalaryTotal,jdbcType=DECIMAL}, #{excelCostTotal,jdbcType=DECIMAL},
        #{excelAuditTimeFirst,jdbcType=LONGVARCHAR}, #{excelAuditMemberFirst,jdbcType=LONGVARCHAR},
        #{excelAuditRemarkFirst,jdbcType=VARCHAR}, #{excelAuditTimeSecond,jdbcType=LONGVARCHAR},
        #{excelAuditMemberSecond,jdbcType=LONGVARCHAR}, #{excelAuditRemarkSecond,jdbcType=VARCHAR},
        #{excelAuditTimeThird,jdbcType=VARCHAR}, #{excelAuditMemberThird,jdbcType=VARCHAR},
        #{excelAuditRemarkThird,jdbcType=VARCHAR},#{excelGrantState,jdbcType=INTEGER},#{excelPayday,jdbcType=TIMESTAMP},
        #{excelPayrollNumber,jdbcType=INTEGER}, #{excelGroupName,jdbcType=VARCHAR})
    </insert>
    <insert id="insertSelective" parameterType="com.xtr.api.domain.company.CompanySalaryExcelBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        insert into company_salary_excel
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="excelId != null">
                excel_id,
            </if>
            <if test="excelCompanyId != null">
                excel_company_id,
            </if>
            <if test="excelDepId != null">
                excel_dep_id,
            </if>
            <if test="excelYear != null">
                excel_year,
            </if>
            <if test="excelMonth != null">
                excel_month,
            </if>
            <if test="excelName != null">
                excel_name,
            </if>
            <if test="excelAddtime != null">
                excel_addtime,
            </if>
            <if test="excelState != null">
                excel_state,
            </if>
            <if test="excelPath != null">
                excel_path,
            </if>
            <if test="excelAddmember != null">
                excel_addmember,
            </if>
            <if test="excelSalaryTotal != null">
                excel_salary_total,
            </if>
            <if test="excelCostTotal != null">
                excel_cost_total,
            </if>
            <if test="excelAuditTimeFirst != null">
                excel_audit_time_first,
            </if>
            <if test="excelAuditMemberFirst != null">
                excel_audit_member_first,
            </if>
            <if test="excelAuditRemarkFirst != null">
                excel_audit_remark_first,
            </if>
            <if test="excelAuditTimeSecond != null">
                excel_audit_time_second,
            </if>
            <if test="excelAuditMemberSecond != null">
                excel_audit_member_second,
            </if>
            <if test="excelAuditRemarkSecond != null">
                excel_audit_remark_second,
            </if>
            <if test="excelAuditTimeThird != null">
                excel_audit_time_third,
            </if>
            <if test="excelAuditMemberThird != null">
                excel_audit_member_third,
            </if>
            <if test="excelAuditRemarkThird != null">
                excel_audit_remark_third,
            </if>
            <if test="excelGrantState != null">
                excel_grant_state,
            </if>
            <if test="excelPayday != null">
                excel_payday,
            </if>
            <if test="excelPayrollNumber != null">
                excel_payroll_number,
            </if>
            <if test="excelGroupName != null">
                excel_group_name,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="excelId != null">
                #{excelId,jdbcType=BIGINT},
            </if>
            <if test="excelCompanyId != null">
                #{excelCompanyId,jdbcType=BIGINT},
            </if>
            <if test="excelDepId != null">
                #{excelDepId,jdbcType=BIGINT},
            </if>
            <if test="excelYear != null">
                #{excelYear,jdbcType=INTEGER},
            </if>
            <if test="excelMonth != null">
                #{excelMonth,jdbcType=INTEGER},
            </if>
            <if test="excelName != null">
                #{excelName,jdbcType=VARCHAR},
            </if>
            <if test="excelAddtime != null">
                #{excelAddtime,jdbcType=TIMESTAMP},
            </if>
            <if test="excelState != null">
                #{excelState,jdbcType=INTEGER},
            </if>
            <if test="excelPath != null">
                #{excelPath,jdbcType=VARCHAR},
            </if>
            <if test="excelAddmember != null">
                #{excelAddmember,jdbcType=BIGINT},
            </if>
            <if test="excelSalaryTotal != null">
                #{excelSalaryTotal,jdbcType=DECIMAL},
            </if>
            <if test="excelCostTotal != null">
                #{excelCostTotal,jdbcType=DECIMAL},
            </if>
            <if test="excelAuditTimeFirst != null">
                #{excelAuditTimeFirst,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditMemberFirst != null">
                #{excelAuditMemberFirst,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditRemarkFirst != null">
                #{excelAuditRemarkFirst,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditTimeSecond != null">
                #{excelAuditTimeSecond,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditMemberSecond != null">
                #{excelAuditMemberSecond,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditRemarkSecond != null">
                #{excelAuditRemarkSecond,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditTimeThird != null">
                #{excelAuditTimeThird,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditMemberThird != null">
                #{excelAuditMemberThird,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditRemarkThird != null">
                #{excelAuditRemarkThird,jdbcType=VARCHAR},
            </if>
            <if test="excelGrantState != null">
                #{excelGrantState,jdbcType=INTEGER},
            </if>
            <if test="excelPayday != null">
                #{excelPayday,jdbcType=TIMESTAMP},
            </if>
            <if test="excelPayrollNumber != null">
                #{excelPayrollNumber,jdbcType=INTEGER},
            </if>
            <if test="excelGroupName != null">
                #{excelGroupName,jdbcType=VARCHAR},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.xtr.api.domain.company.CompanySalaryExcelBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update company_salary_excel
        <set>
            <if test="excelCompanyId != null">
                excel_company_id = #{excelCompanyId,jdbcType=BIGINT},
            </if>
            <if test="excelDepId != null">
                excel_dep_id = #{excelDepId,jdbcType=BIGINT},
            </if>
            <if test="excelYear != null">
                excel_year = #{excelYear,jdbcType=INTEGER},
            </if>
            <if test="excelMonth != null">
                excel_month = #{excelMonth,jdbcType=INTEGER},
            </if>
            <if test="excelName != null">
                excel_name = #{excelName,jdbcType=VARCHAR},
            </if>
            <if test="excelAddtime != null">
                excel_addtime = #{excelAddtime,jdbcType=TIMESTAMP},
            </if>
            <if test="excelState != null">
                excel_state = #{excelState,jdbcType=INTEGER},
            </if>
            <if test="excelPath != null">
                excel_path = #{excelPath,jdbcType=VARCHAR},
            </if>
            <if test="excelAddmember != null">
                excel_addmember = #{excelAddmember,jdbcType=BIGINT},
            </if>
            <if test="excelSalaryTotal != null">
                excel_salary_total = #{excelSalaryTotal,jdbcType=DECIMAL},
            </if>
            <if test="excelCostTotal != null">
                excel_cost_total = #{excelCostTotal,jdbcType=DECIMAL},
            </if>
            <if test="excelAuditTimeFirst != null">
                excel_audit_time_first = #{excelAuditTimeFirst,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditMemberFirst != null">
                excel_audit_member_first = #{excelAuditMemberFirst,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditRemarkFirst != null">
                excel_audit_remark_first = #{excelAuditRemarkFirst,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditTimeSecond != null">
                excel_audit_time_second = #{excelAuditTimeSecond,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditMemberSecond != null">
                excel_audit_member_second = #{excelAuditMemberSecond,jdbcType=LONGVARCHAR},
            </if>
            <if test="excelAuditRemarkSecond != null">
                excel_audit_remark_second = #{excelAuditRemarkSecond,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditTimeThird != null">
                excel_audit_time_third = #{excelAuditTimeThird,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditMemberThird != null">
                excel_audit_member_third = #{excelAuditMemberThird,jdbcType=VARCHAR},
            </if>
            <if test="excelAuditRemarkThird != null">
                excel_audit_remark_third = #{excelAuditRemarkThird,jdbcType=VARCHAR},
            </if>
            <if test="excelGrantState != null">
                excel_grant_state = #{excelGrantState,jdbcType=INTEGER},
            </if>
            <if test="excelPayday != null">
                excel_payday = #{excelPayday,jdbcType=TIMESTAMP},
            </if>
            <if test="excelPayrollNumber != null">
                excel_payroll_number = #{excelPayrollNumber,jdbcType=INTEGER},
            </if>
            <if test="excelGroupName != null">
                excel_group_name = #{excelGroupName,jdbcType=INTEGER},
            </if>
        </set>
        where excel_id = #{excelId,jdbcType=BIGINT}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.xtr.api.domain.company.CompanySalaryExcelBean">
        <!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
        update company_salary_excel
        set excel_company_id = #{excelCompanyId,jdbcType=BIGINT},
        excel_dep_id = #{excelDepId,jdbcType=BIGINT},
        excel_year = #{excelYear,jdbcType=INTEGER},
        excel_month = #{excelMonth,jdbcType=INTEGER},
        excel_name = #{excelName,jdbcType=VARCHAR},
        excel_addtime = #{excelAddtime,jdbcType=TIMESTAMP},
        excel_state = #{excelState,jdbcType=INTEGER},
        excel_path = #{excelPath,jdbcType=VARCHAR},
        excel_addmember = #{excelAddmember,jdbcType=BIGINT},
        excel_salary_total = #{excelSalaryTotal,jdbcType=DECIMAL},
        excel_cost_total = #{excelCostTotal,jdbcType=DECIMAL},
        excel_audit_time_first = #{excelAuditTimeFirst,jdbcType=LONGVARCHAR},
        excel_audit_member_first = #{excelAuditMemberFirst,jdbcType=LONGVARCHAR},
        excel_audit_remark_first = #{excelAuditRemarkFirst,jdbcType=VARCHAR},
        excel_audit_time_second = #{excelAuditTimeSecond,jdbcType=LONGVARCHAR},
        excel_audit_member_second = #{excelAuditMemberSecond,jdbcType=LONGVARCHAR},
        excel_audit_remark_second = #{excelAuditRemarkSecond,jdbcType=VARCHAR},
        excel_audit_time_third = #{excelAuditTimeThird,jdbcType=VARCHAR},
        excel_audit_member_third = #{excelAuditMemberThird,jdbcType=VARCHAR},
        excel_audit_remark_third = #{excelAuditRemarkThird,jdbcType=VARCHAR},
        excel_grant_state = #{excelGrantState,jdbcType=INTEGER},
        excel_payday = #{excelPayday,jdbcType=TIMESTAMP},
        excel_payroll_number = #{excelPayrollNumber,jdbcType=INTEGER},
        excel_group_name = #{excelGroupName,jdbcType=VARCHAR}
        where excel_id = #{excelId,jdbcType=BIGINT}
    </update>

    <!-- 更新工资单状态-->
    <update id="updateGrantState">
        UPDATE company_salary_excel
        set excel_grant_state = #{excelGrantState,jdbcType=INTEGER}
        where excel_id = #{excelId,jdbcType=BIGINT}
        and excel_grant_state = #{oldGrantState,jdbcType=INTEGER}
    </update>

    <!-- 更新工资单实发金额  状态必须为发放中-->
    <update id="updateSalaryTotal">
        UPDATE company_salary_excel
        set excel_salary_total = #{amount,jdbcType=DECIMAL}
        where excel_id = #{excelId,jdbcType=BIGINT}
        and excel_grant_state = 1
    </update>

</mapper>