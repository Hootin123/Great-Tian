<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xtr.core.persistence.writer.company.CompanyMembersWriterMapper" >

  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from company_members
    where member_id = #{memberId,jdbcType=BIGINT}
  </delete>
  <insert id="insert" parameterType="com.xtr.api.domain.company.CompanyMembersBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into company_members (member_id, member_company_id, member_dep_id, 
      member_name, member_power_ids, member_power_names, 
      member_logname, member_password, member_password_strength, 
      member_idcard, member_phone, member_email, 
      member_rolename, member_login_errtimes, member_login_err_time, 
      member_isdefault, member_sign,register_time,company_name,member_login_recent_time,member_status)
    values (#{memberId,jdbcType=BIGINT}, #{memberCompanyId,jdbcType=BIGINT}, #{memberDepId,jdbcType=BIGINT}, 
      #{memberName,jdbcType=VARCHAR}, #{memberPowerIds,jdbcType=VARCHAR}, #{memberPowerNames,jdbcType=VARCHAR}, 
      #{memberLogname,jdbcType=VARCHAR}, #{memberPassword,jdbcType=VARCHAR}, #{memberPasswordStrength,jdbcType=INTEGER}, 
      #{memberIdcard,jdbcType=VARCHAR}, #{memberPhone,jdbcType=VARCHAR}, #{memberEmail,jdbcType=VARCHAR}, 
      #{memberRolename,jdbcType=VARCHAR}, #{memberLoginErrtimes,jdbcType=INTEGER}, #{memberLoginErrTime,jdbcType=TIMESTAMP}, 
      #{memberIsdefault,jdbcType=INTEGER}, #{memberSign,jdbcType=INTEGER}, #{registerTime,jdbcType=TIMESTAMP},#{companyName,jdbcType=VARCHAR},#{memberLoginRecentTime,jdbcType=TIMESTAMP}, #{memberStatus,jdbcType=INTEGER})
    <selectKey resultType="java.lang.Long" order="AFTER" keyProperty="memberId">
      SELECT LAST_INSERT_ID() AS memberId
    </selectKey>
  </insert>
  <insert id="insertSelective" parameterType="com.xtr.api.domain.company.CompanyMembersBean" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into company_members
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="memberId != null" >
        member_id,
      </if>
      <if test="memberCompanyId != null" >
        member_company_id,
      </if>
      <if test="memberDepId != null" >
        member_dep_id,
      </if>
      <if test="memberName != null" >
        member_name,
      </if>
      <if test="memberPowerIds != null" >
        member_power_ids,
      </if>
      <if test="memberPowerNames != null" >
        member_power_names,
      </if>
      <if test="memberLogname != null" >
        member_logname,
      </if>
      <if test="memberPassword != null" >
        member_password,
      </if>
      <if test="memberPasswordStrength != null" >
        member_password_strength,
      </if>
      <if test="memberIdcard != null" >
        member_idcard,
      </if>
      <if test="memberPhone != null" >
        member_phone,
      </if>
      <if test="memberEmail != null" >
        member_email,
      </if>
      <if test="memberRolename != null" >
        member_rolename,
      </if>
      <if test="memberLoginErrtimes != null" >
        member_login_errtimes,
      </if>
      <if test="memberLoginErrTime != null" >
        member_login_err_time,
      </if>
      <if test="memberIsdefault != null" >
        member_isdefault,
      </if>
      <if test="memberSign != null" >
        member_sign,
      </if>
      register_time,
      <if test="companyName != null" >
        company_name,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="memberId != null" >
        #{memberId,jdbcType=BIGINT},
      </if>
      <if test="memberCompanyId != null" >
        #{memberCompanyId,jdbcType=BIGINT},
      </if>
      <if test="memberDepId != null" >
        #{memberDepId,jdbcType=BIGINT},
      </if>
      <if test="memberName != null" >
        #{memberName,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerIds != null" >
        #{memberPowerIds,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerNames != null" >
        #{memberPowerNames,jdbcType=VARCHAR},
      </if>
      <if test="memberLogname != null" >
        #{memberLogname,jdbcType=VARCHAR},
      </if>
      <if test="memberPassword != null" >
        #{memberPassword,jdbcType=VARCHAR},
      </if>
      <if test="memberPasswordStrength != null" >
        #{memberPasswordStrength,jdbcType=INTEGER},
      </if>
      <if test="memberIdcard != null" >
        #{memberIdcard,jdbcType=VARCHAR},
      </if>
      <if test="memberPhone != null" >
        #{memberPhone,jdbcType=VARCHAR},
      </if>
      <if test="memberEmail != null" >
        #{memberEmail,jdbcType=VARCHAR},
      </if>
      <if test="memberRolename != null" >
        #{memberRolename,jdbcType=VARCHAR},
      </if>
      <if test="memberLoginErrtimes != null" >
        #{memberLoginErrtimes,jdbcType=INTEGER},
      </if>
      <if test="memberLoginErrTime != null" >
        #{memberLoginErrTime,jdbcType=TIMESTAMP},
      </if>
      <if test="memberIsdefault != null" >
        #{memberIsdefault,jdbcType=INTEGER},
      </if>
      <if test="memberSign != null" >
        #{memberSign,jdbcType=INTEGER},
      </if>
       #{registerTime,jdbcType=TIMESTAMP}
      <if test="companyName != null" >
        #{companyName,jdbcType=VARCHAR},
      </if>
    </trim>


  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.xtr.api.domain.company.CompanyMembersBean" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update company_members
    <set >
      <if test="memberCompanyId != null" >
        member_company_id = #{memberCompanyId,jdbcType=BIGINT},
      </if>
      <if test="memberDepId != null" >
        member_dep_id = #{memberDepId,jdbcType=BIGINT},
      </if>
      <if test="memberName != null" >
        member_name = #{memberName,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerIds != null" >
        member_power_ids = #{memberPowerIds,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerNames != null" >
        member_power_names = #{memberPowerNames,jdbcType=VARCHAR},
      </if>
      <if test="memberLogname != null" >
        member_logname = #{memberLogname,jdbcType=VARCHAR},
      </if>
      <if test="memberPassword != null" >
        member_password = #{memberPassword,jdbcType=VARCHAR},
      </if>
      <if test="memberPasswordStrength != null" >
        member_password_strength = #{memberPasswordStrength,jdbcType=INTEGER},
      </if>
      <if test="memberIdcard != null" >
        member_idcard = #{memberIdcard,jdbcType=VARCHAR},
      </if>
      <if test="memberPhone != null" >
        member_phone = #{memberPhone,jdbcType=VARCHAR},
      </if>
      <if test="memberEmail != null" >
        member_email = #{memberEmail,jdbcType=VARCHAR},
      </if>
      <if test="memberRolename != null" >
        member_rolename = #{memberRolename,jdbcType=VARCHAR},
      </if>
      <if test="memberLoginErrtimes != null" >
        member_login_errtimes = #{memberLoginErrtimes,jdbcType=INTEGER},
      </if>
      <if test="memberLoginErrTime != null" >
        member_login_err_time = #{memberLoginErrTime,jdbcType=TIMESTAMP},
      </if>
      <if test="memberIsdefault != null" >
        member_isdefault = #{memberIsdefault,jdbcType=INTEGER},
      </if>
      <if test="memberSign != null" >
        member_sign = #{memberSign,jdbcType=INTEGER},
      </if>
      <if test="companyName != null" >
        company_name = #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="memberLoginRecentTime != null" >
        member_login_recent_time = #{memberLoginRecentTime,jdbcType=TIMESTAMP},
      </if>
      <if test="memberStatus != null" >
        member_status = #{memberStatus,jdbcType=INTEGER},
      </if>
    </set>
    where member_id = #{memberId,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.xtr.api.domain.company.CompanyMembersBean" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update company_members
    set member_company_id = #{memberCompanyId,jdbcType=BIGINT},
      member_dep_id = #{memberDepId,jdbcType=BIGINT},
      member_name = #{memberName,jdbcType=VARCHAR},
      member_power_ids = #{memberPowerIds,jdbcType=VARCHAR},
      member_power_names = #{memberPowerNames,jdbcType=VARCHAR},
      member_logname = #{memberLogname,jdbcType=VARCHAR},
      member_password = #{memberPassword,jdbcType=VARCHAR},
      member_password_strength = #{memberPasswordStrength,jdbcType=INTEGER},
      member_idcard = #{memberIdcard,jdbcType=VARCHAR},
      member_phone = #{memberPhone,jdbcType=VARCHAR},
      member_email = #{memberEmail,jdbcType=VARCHAR},
      member_rolename = #{memberRolename,jdbcType=VARCHAR},
      member_login_errtimes = #{memberLoginErrtimes,jdbcType=INTEGER},
      member_login_err_time = #{memberLoginErrTime,jdbcType=TIMESTAMP},
      member_isdefault = #{memberIsdefault,jdbcType=INTEGER},
      member_sign = #{memberSign,jdbcType=INTEGER},
      company_name = #{companyName,jdbcType=VARCHAR}
    where member_id = #{memberId,jdbcType=BIGINT}
  </update>
  <update id="updateByCondition" parameterType="com.xtr.api.domain.company.CompanyMembersBean">
    update company_members
    <set >
      <if test="memberCompanyId != null" >
        member_company_id = #{memberCompanyId,jdbcType=BIGINT},
      </if>
      <if test="memberDepId != null" >
        member_dep_id = #{memberDepId,jdbcType=BIGINT},
      </if>
      <if test="memberName != null" >
        member_name = #{memberName,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerIds != null" >
        member_power_ids = #{memberPowerIds,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerNames != null" >
        member_power_names = #{memberPowerNames,jdbcType=VARCHAR},
      </if>
      <if test="memberLogname != null" >
        member_logname = #{memberLogname,jdbcType=VARCHAR},
      </if>
      <if test="memberPassword != null" >
        member_password = #{memberPassword,jdbcType=VARCHAR},
      </if>
      <if test="memberPasswordStrength != null" >
        member_password_strength = #{memberPasswordStrength,jdbcType=INTEGER},
      </if>
      <if test="memberIdcard != null" >
        member_idcard = #{memberIdcard,jdbcType=VARCHAR},
      </if>
      <if test="memberPhone != null" >
        member_phone = #{memberPhone,jdbcType=VARCHAR},
      </if>
      <if test="memberEmail != null" >
        member_email = #{memberEmail,jdbcType=VARCHAR},
      </if>
      <if test="memberRolename != null" >
        member_rolename = #{memberRolename,jdbcType=VARCHAR},
      </if>
      <if test="memberLoginErrtimes != null" >
        member_login_errtimes = #{memberLoginErrtimes,jdbcType=INTEGER},
      </if>
      <if test="memberLoginErrTime != null" >
        member_login_err_time = #{memberLoginErrTime,jdbcType=TIMESTAMP},
      </if>
      <if test="memberIsdefault != null" >
        member_isdefault = #{memberIsdefault,jdbcType=INTEGER},
      </if>
      <if test="memberSign != null" >
        member_sign = #{memberSign,jdbcType=INTEGER},
      </if>
      <if test="companyName != null" >
        company_name = #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="registerTime != null" >
        register_time = #{registerTime,jdbcType=VARCHAR},
      </if>

    </set>
    where member_logname = #{memberLogname,jdbcType=VARCHAR}
  </update>
  <!--通过手机号更改用户信息-->
  <update id="updateByPhone" parameterType="com.xtr.api.domain.company.CompanyMembersBean">
    update company_members
    <set >
      <if test="memberCompanyId != null" >
        member_company_id = #{memberCompanyId,jdbcType=BIGINT},
      </if>
      <if test="memberDepId != null" >
        member_dep_id = #{memberDepId,jdbcType=BIGINT},
      </if>
      <if test="memberName != null" >
        member_name = #{memberName,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerIds != null" >
        member_power_ids = #{memberPowerIds,jdbcType=VARCHAR},
      </if>
      <if test="memberPowerNames != null" >
        member_power_names = #{memberPowerNames,jdbcType=VARCHAR},
      </if>
      <if test="memberLogname != null" >
        member_logname = #{memberLogname,jdbcType=VARCHAR},
      </if>
      <if test="memberPassword != null" >
        member_password = #{memberPassword,jdbcType=VARCHAR},
      </if>
      <if test="memberPasswordStrength != null" >
        member_password_strength = #{memberPasswordStrength,jdbcType=INTEGER},
      </if>
      <if test="memberIdcard != null" >
        member_idcard = #{memberIdcard,jdbcType=VARCHAR},
      </if>
      <if test="memberEmail != null" >
        member_email = #{memberEmail,jdbcType=VARCHAR},
      </if>
      <if test="memberRolename != null" >
        member_rolename = #{memberRolename,jdbcType=VARCHAR},
      </if>
      <if test="memberLoginErrtimes != null" >
        member_login_errtimes = #{memberLoginErrtimes,jdbcType=INTEGER},
      </if>
      <if test="memberLoginErrTime != null" >
        member_login_err_time = #{memberLoginErrTime,jdbcType=TIMESTAMP},
      </if>
      <if test="memberIsdefault != null" >
        member_isdefault = #{memberIsdefault,jdbcType=INTEGER},
      </if>
      <if test="memberSign != null" >
        member_sign = #{memberSign,jdbcType=INTEGER},
      </if>
      <if test="companyName != null" >
        company_name = #{companyName,jdbcType=VARCHAR},
      </if>
      <if test="registerTime != null" >
        register_time = #{registerTime,jdbcType=VARCHAR},
      </if>
    </set>
    where member_phone = #{memberPhone,jdbcType=VARCHAR}
  </update>

  <!--插入用户返回longId -->
  <insert id="insertForReturnId" parameterType="com.xtr.api.domain.company.CompanyMembersBean" useGeneratedKeys="true" keyProperty="memberId">
    insert into company_members (member_id, member_company_id, member_dep_id,
    member_name, member_power_ids, member_power_names,
    member_logname, member_password, member_password_strength,
    member_idcard, member_phone, member_email,
    member_rolename, member_login_errtimes, member_login_err_time,
    member_isdefault, member_sign,register_time,company_name,member_login_recent_time,member_status,member_push_number)
    values (#{memberId,jdbcType=BIGINT}, #{memberCompanyId,jdbcType=BIGINT}, #{memberDepId,jdbcType=BIGINT},
    #{memberName,jdbcType=VARCHAR}, #{memberPowerIds,jdbcType=VARCHAR}, #{memberPowerNames,jdbcType=VARCHAR},
    #{memberLogname,jdbcType=VARCHAR}, #{memberPassword,jdbcType=VARCHAR}, #{memberPasswordStrength,jdbcType=INTEGER},
    #{memberIdcard,jdbcType=VARCHAR}, #{memberPhone,jdbcType=VARCHAR}, #{memberEmail,jdbcType=VARCHAR},
    #{memberRolename,jdbcType=VARCHAR}, #{memberLoginErrtimes,jdbcType=INTEGER}, #{memberLoginErrTime,jdbcType=TIMESTAMP},
    #{memberIsdefault,jdbcType=INTEGER}, #{memberSign,jdbcType=INTEGER}, #{registerTime,jdbcType=TIMESTAMP},#{companyName,jdbcType=VARCHAR},#{memberLoginRecentTime,jdbcType=TIMESTAMP},#{memberStatus},#{memberPushNumber})
  </insert>

  <insert id="companyRoleRelBeanAdd" parameterType="com.xtr.api.domain.company.CompanyRoleRelBean" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into company_role_rel (role_id, obj_id, rel_type)
    values (#{roleId,jdbcType=BIGINT}, #{objId,jdbcType=BIGINT}, #{relType,jdbcType=INTEGER})
  </insert>

  <delete id="deleteRoleRelBeanById" parameterType="com.xtr.api.domain.company.CompanyRoleRelBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from company_role_rel
    where obj_id = #{objId,jdbcType=BIGINT} AND rel_type = #{relType,jdbcType=INTEGER}
  </delete>

  <!-- 新增待办事项-->
  <insert id="addTodoMater" useGeneratedKeys="true"  keyProperty="materId" parameterType="com.xtr.api.domain.company.TodoMaterBean">

       INSERT
        INTO
         todo_mater (mater_id,mater_content,mater_member_id,mater_company_id,mater_create_time,mater_update_time,mater_status)
      VALUES
      (#{materId},#{materContent},#{materMemberId},#{materCompanyId},#{materCreateTime},#{materUpdateTime},#{materStatus})
  </insert>
  <!-- 更新待办事项-->
  <update id="updateMaterById" parameterType="com.xtr.api.domain.company.TodoMaterBean">
    update todo_mater
    SET
    mater_content=#{materContent},
    mater_update_time=#{materUpdateTime}
    where 1=1 AND
    mater_id =#{materId}
  </update>
  <!-- 逻辑删除待办事项-->
  <update id="deleteMaterById" parameterType="java.lang.Long">
    update todo_mater
    set mater_status = 1,
    mater_update_time=now()
    where mater_id=#{materId}
  </update>
  <!-- 保存访问记录-->
<insert id="saveVisitRecord" parameterType="com.xtr.api.domain.company.CompanyMenuVisitRecordBean" useGeneratedKeys="true">
  insert into company_menu_visit_record(company_id,member_id,type,visit_time,ip)
  values(#{companyId},#{memberId},#{type},#{visitTime},#{ip})

</insert>
</mapper>