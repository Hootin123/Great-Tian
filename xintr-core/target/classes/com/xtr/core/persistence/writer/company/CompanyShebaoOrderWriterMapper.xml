<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.xtr.core.persistence.writer.company.CompanyShebaoOrderWriterMapper" >

  <delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from company_shebao_order
    where id = #{id,jdbcType=BIGINT}
  </delete>
  <delete id="deleteCompanyOrderIfEmpty">
    DELETE from company_shebao_order
    WHERE
        id = #{id}
    AND (
        SELECT
            count(1)
        FROM
            customer_shebao_order t2
        WHERE
            t2.company_shebao_order_id = #{id}
    ) = 0
  </delete>
  <insert id="insert" parameterType="com.xtr.api.domain.company.CompanyShebaoOrderBean" useGeneratedKeys="true" keyProperty="id">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into company_shebao_order (company_id, order_number,
    join_city_name, join_city_code, order_date, update_base_date,
    order_sb_detail, order_gjj_detail, price_sum,
    price_sb, price_gjj, price_addtion,
    price_service, price_var1, price_single,
    customer_count, status, last_time,
    require_last_time, order_last_time, is_current, submit_time,
    create_time)
    values (#{companyId,jdbcType=BIGINT}, #{orderNumber,jdbcType=VARCHAR},
    #{joinCityName,jdbcType=VARCHAR}, #{joinCityCode,jdbcType=VARCHAR}, #{orderDate,jdbcType=DATE}, #{updateBaseDate,jdbcType=DATE},
    #{orderSbDetail,jdbcType=VARCHAR}, #{orderGjjDetail,jdbcType=VARCHAR}, #{priceSum,jdbcType=DECIMAL},
    #{priceSb,jdbcType=DECIMAL}, #{priceGjj,jdbcType=DECIMAL}, #{priceAddtion,jdbcType=DECIMAL},
    #{priceService,jdbcType=DECIMAL}, #{priceVar1,jdbcType=DECIMAL}, #{priceSingle,jdbcType=DECIMAL},
    #{customerCount,jdbcType=INTEGER}, #{status,jdbcType=INTEGER}, #{lastTime,jdbcType=TIMESTAMP},
    #{requireLastTime,jdbcType=TIMESTAMP}, #{orderLastTime,jdbcType=TIMESTAMP}, #{isCurrent}, #{submitTime,jdbcType=TIMESTAMP},
    #{createTime,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.xtr.api.domain.company.CompanyShebaoOrderBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    insert into company_shebao_order
    <trim prefix="(" suffix=")" suffixOverrides=",">
      <if test="id != null">
        id,
      </if>
      <if test="companyId != null">
        company_id,
      </if>
      <if test="orderNumber != null">
        order_number,
      </if>
      <if test="joinCityName != null">
        join_city_name,
      </if>
      <if test="joinCityCode != null">
        join_city_code,
      </if>
      <if test="orderDate != null">
        order_date,
      </if>
      <if test="updateBaseDate != null">
        update_base_date,
      </if>
      <if test="orderSbDetail != null">
        order_sb_detail,
      </if>
      <if test="orderGjjDetail != null">
        order_gjj_detail,
      </if>
      <if test="priceSum != null">
        price_sum,
      </if>
      <if test="priceSb != null">
        price_sb,
      </if>
      <if test="priceGjj != null">
        price_gjj,
      </if>
      <if test="priceAddtion != null">
        price_addtion,
      </if>
      <if test="priceService != null">
        price_service,
      </if>
      <if test="priceVar1 != null">
        price_var1,
      </if>
      <if test="priceSingle != null">
        price_single,
      </if>
      <if test="customerCount != null">
        customer_count,
      </if>
      <if test="status != null">
        status,
      </if>
      <if test="lastTime != null">
        last_time,
      </if>
      <if test="requireLastTime != null">
        require_last_time,
      </if>
      <if test="orderLastTime != null">
        order_last_time,
      </if>
      <if test="isCurrent != null">
        is_current,
      </if>
      <if test="submitTime != null">
        submit_time,
      </if>
      <if test="createTime != null">
        create_time,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides=",">
      <if test="id != null">
        #{id,jdbcType=BIGINT},
      </if>
      <if test="companyId != null">
        #{companyId,jdbcType=BIGINT},
      </if>
      <if test="orderNumber != null">
        #{orderNumber,jdbcType=VARCHAR},
      </if>
      <if test="joinCityName != null">
        #{joinCityName,jdbcType=VARCHAR},
      </if>
      <if test="joinCityCode != null">
        #{joinCityCode,jdbcType=VARCHAR},
      </if>
      <if test="orderDate != null">
        #{orderDate,jdbcType=DATE},
      </if>
      <if test="updateBaseDate != null">
        #{updateBaseDate,jdbcType=DATE},
      </if>
      <if test="orderSbDetail != null">
        #{orderSbDetail,jdbcType=VARCHAR},
      </if>
      <if test="orderGjjDetail != null">
        #{orderGjjDetail,jdbcType=VARCHAR},
      </if>
      <if test="priceSum != null">
        #{priceSum,jdbcType=DECIMAL},
      </if>
      <if test="priceSb != null">
        #{priceSb,jdbcType=DECIMAL},
      </if>
      <if test="priceGjj != null">
        #{priceGjj,jdbcType=DECIMAL},
      </if>
      <if test="priceAddtion != null">
        #{priceAddtion,jdbcType=DECIMAL},
      </if>
      <if test="priceService != null">
        #{priceService,jdbcType=DECIMAL},
      </if>
      <if test="priceVar1 != null">
        #{priceVar1,jdbcType=DECIMAL},
      </if>
      <if test="priceSingle != null">
        #{priceSingle,jdbcType=DECIMAL},
      </if>
      <if test="customerCount != null">
        #{customerCount,jdbcType=INTEGER},
      </if>
      <if test="status != null">
        #{status,jdbcType=INTEGER},
      </if>
      <if test="lastTime != null">
        #{lastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="requireLastTime != null">
        #{requireLastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderLastTime != null">
        #{orderLastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isCurrent != null">
        #{isCurrent,jdbcType=INTEGER},
      </if>
      <if test="submitTime != null">
        #{submitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null">
        #{createTime,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.xtr.api.domain.company.CompanyShebaoOrderBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update company_shebao_order
    <set>
      <if test="companyId != null">
        company_id = #{companyId,jdbcType=BIGINT},
      </if>
      <if test="orderNumber != null">
        order_number = #{orderNumber,jdbcType=VARCHAR},
      </if>
      <if test="joinCityName != null">
        join_city_name = #{joinCityName,jdbcType=VARCHAR},
      </if>
      <if test="joinCityCode != null">
        join_city_code = #{joinCityCode,jdbcType=VARCHAR},
      </if>
      <if test="orderDate != null">
        order_date = #{orderDate,jdbcType=DATE},
      </if>
      <if test="updateBaseDate != null">
        update_base_date = #{updateBaseDate,jdbcType=DATE},
      </if>
      <if test="orderSbDetail != null">
        order_sb_detail = #{orderSbDetail,jdbcType=VARCHAR},
      </if>
      <if test="orderGjjDetail != null">
        order_gjj_detail = #{orderGjjDetail,jdbcType=VARCHAR},
      </if>
      <if test="priceSum != null">
        price_sum = #{priceSum,jdbcType=DECIMAL},
      </if>
      <if test="priceSb != null">
        price_sb = #{priceSb,jdbcType=DECIMAL},
      </if>
      <if test="priceGjj != null">
        price_gjj = #{priceGjj,jdbcType=DECIMAL},
      </if>
      <if test="priceAddtion != null">
        price_addtion = #{priceAddtion,jdbcType=DECIMAL},
      </if>
      <if test="priceService != null">
        price_service = #{priceService,jdbcType=DECIMAL},
      </if>
      <if test="priceVar1 != null">
        price_var1 = #{priceVar1,jdbcType=DECIMAL},
      </if>
      <if test="priceSingle != null">
        price_single = #{priceSingle,jdbcType=DECIMAL},
      </if>
      <if test="customerCount != null">
        customer_count = #{customerCount,jdbcType=INTEGER},
      </if>
      <if test="status != null">
        status = #{status,jdbcType=INTEGER},
      </if>
      <if test="lastTime != null">
        last_time = #{lastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="requireLastTime != null">
        require_last_time = #{requireLastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="orderLastTime != null">
        order_last_time = #{orderLastTime,jdbcType=TIMESTAMP},
      </if>
      <if test="isCurrent != null">
        is_current = #{isCurrent,jdbcType=TIMESTAMP},
      </if>
      <if test="submitTime != null">
        submit_time = #{submitTime,jdbcType=TIMESTAMP},
      </if>
      <if test="createTime != null">
        create_time = #{createTime,jdbcType=TIMESTAMP},
      </if>
      <if test="shebaotongTotalAmount != null">
        shebaotong_total_amount = #{shebaotongTotalAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongServiceAmount != null">
        shebaotong_service_amount = #{shebaotongServiceAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongReceiveAmount != null">
        shebaotong_receive_amount = #{shebaotongReceiveAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongBackAmount != null">
        shebaotong_back_amount = #{shebaotongBackAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongOverdueAmount != null">
        shebaotong_overdue_amount = #{shebaotongOverdueAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongShebaoAmount != null">
        shebaotong_shebao_amount = #{shebaotongShebaoAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongGjjAmount != null">
        shebaotong_gjj_amount = #{shebaotongGjjAmount,jdbcType=DECIMAL},
      </if>
      <if test="shebaotongServiceNumber != null">
        shebaotong_service_number = #{shebaotongServiceNumber,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayBankName != null">
        shebaotong_pay_bank_name = #{shebaotongPayBankName,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayCompanyAccount != null">
        shebaotong_pay_company_account = #{shebaotongPayCompanyAccount,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayBankNo != null">
        shebaotong_pay_bank_no = #{shebaotongPayBankNo,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayBatch != null">
        shebaotong_pay_batch = #{shebaotongPayBatch,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayOperator != null">
        shebaotong_pay_operator = #{shebaotongPayOperator,jdbcType=BIGINT},
      </if>
      <if test="shebaotongReturnMessage != null">
        shebaotong_return_message = #{shebaotongReturnMessage,jdbcType=VARCHAR},
      </if>
      <if test="shebaotongPayImg != null">
        shebaotong_pay_img = #{shebaotongPayImg,jdbcType=VARCHAR},
      </if>

      <if test="shebaoFailMsg != null">
        shebao_fail_msg = #{shebaoFailMsg,jdbcType=VARCHAR},
      </if>
      <if test="shebaoCustomerPayStatus != null">
        shebao_customer_pay_status = #{shebaoCustomerPayStatus,jdbcType=INTEGER},
      </if>
      <if test="shebaoFinanceUser != null">
        shebao_finance_user = #{shebaoFinanceUser,jdbcType=VARCHAR},
      </if>
      <if test="shebaoRemark != null">
        shebao_remark = #{shebaoRemark,jdbcType=VARCHAR},
      </if>
    </set>
    where id = #{id,jdbcType=BIGINT}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.xtr.api.domain.company.CompanyShebaoOrderBean">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update company_shebao_order
    set company_id = #{companyId,jdbcType=BIGINT},
    order_number = #{orderNumber,jdbcType=VARCHAR},
    join_city_name = #{joinCityName,jdbcType=VARCHAR},
    join_city_code = #{joinCityCode,jdbcType=VARCHAR},
    order_date = #{orderDate,jdbcType=DATE},
    update_base_date = #{updateBaseDate,jdbcType=DATE},
    order_sb_detail = #{orderSbDetail,jdbcType=VARCHAR},
    order_gjj_detail = #{orderGjjDetail,jdbcType=VARCHAR},
    price_sum = #{priceSum,jdbcType=DECIMAL},
    price_sb = #{priceSb,jdbcType=DECIMAL},
    price_gjj = #{priceGjj,jdbcType=DECIMAL},
    price_addtion = #{priceAddtion,jdbcType=DECIMAL},
    price_service = #{priceService,jdbcType=DECIMAL},
    price_var1 = #{priceVar1,jdbcType=DECIMAL},
    price_single = #{priceSingle,jdbcType=DECIMAL},
    customer_count = #{customerCount,jdbcType=INTEGER},
    status = #{status,jdbcType=INTEGER},
    last_time = #{lastTime,jdbcType=TIMESTAMP},
    require_last_time = #{requireLastTime,jdbcType=TIMESTAMP},
    order_last_time = #{orderLastTime,jdbcType=TIMESTAMP},
    is_current = #{isCurrent,jdbcType=INTEGER},
    submit_time = #{submitTime,jdbcType=TIMESTAMP},
    create_time = #{createTime,jdbcType=TIMESTAMP}
    where id = #{id,jdbcType=BIGINT}
  </update>

  <update id="updateOtherToDefault">
      update company_shebao_order
      set is_current = 0
      where company_id = #{companyId}
      and join_city_code = #{cityCode}
      and id &lt;> #{currentId}
  </update>

  <update id="updateStatusByOrderNuber">
    update company_shebao_order
    set status = #{orderStatus}
    where shebaotong_service_number = #{orderNumber}
  </update>

  <update id="updateUnSubmitOrder">
    UPDATE company_shebao_order
    SET STATUS = 7
    WHERE
    DATE_FORMAT(order_last_time, '%Y-%m-%d') &lt; DATE_FORMAT(now(), '%Y-%m-%d')
    AND (STATUS = 1 or STATUS = 2)
  </update>

  <update id="updateNoReadOrders" parameterType="java.lang.Long">
     update company_shebao_order
             set read_status='1'
             where company_id=#{companyId}
             and read_status='0'
  </update>
</mapper>