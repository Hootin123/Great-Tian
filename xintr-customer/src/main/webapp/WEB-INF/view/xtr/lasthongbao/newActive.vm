<!DOCTYPE html>
<html lang="en" id='html'>
<head>
	#parse("comm/headNew.vm")
    <meta charset="UTF-8">
    <title>活动详情页</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no,minimum-scale=1,maximum-scale=1">
    <script src="#springUrl('/resource/js/lasthongbao/zepto.min.js')"></script>
    <link rel="stylesheet" type="text/css" href="#springUrl('/resource/css/lasthongbao/active.css')">
</head>
<body>
    <input name="companyContactPlace" type="hidden" value="$!{companyContactPlace}"/>
	<input name="mmtoken" type="hidden" value="$!{mmtoken}"/>
	<div class="page1" style='display: block'>
		<div class="start">
			<img src="#springUrl('/resource/img/lasthongbao/move1.png')">
		</div>
	</div>
	<div class="page2" style='display: none'>
		<div class="pic1">
			<img src="#springUrl('/resource/img/lasthongbao/move2.png')">
		</div>
		<div class="pic2">
			<img src="#springUrl('/resource/img/lasthongbao/move3.png')">
		</div>
		<div class="getMain phone">
			<input type="text" name="phoneNumber" placeholder="请输入手机号"/>
			<b></b>
		</div>
		<div class="getFooter">免费领取</div>
		<div class="loginText">已有账户请登录</div>
		<div class="introduce">
			<img src="#springUrl('/resource/img/lasthongbao/hint.png')">
		</div>
	</div>	
</body>
<script type="text/javascript">

	$('.start').on('touchstart',function(){
		$(this).addClass('move1');
		setTimeout(function(){
			$('.page2').show();
			$('.page1').hide()
			$('.pic1 img').animate({top:0},600)
			$('.pic2').addClass('move3')
		},900)
	})

	var fphone = false;
	// 验证手机号
	$('.phone input').blur(function(){
		testPhone()
	});

	function testPhone(){
		var  reg=/^1[3|5|7|8]\d{9}$/;
		if($(".phone input").val()=='' || $(".phone input").val()==undefined ){
			$('.phone b').html('请输入手机号码');
			fphone = false
		}
	 	else if(reg.test($(".phone input").val())){
	 		$('.phone b').html('');
			fphone = true;
		}
		else{
			$('.phone b').html('请输入正确的手机号');
			fphone = false

		}
	};
	$('.getFooter').on('touchstart',function(){
		testPhone()
		if(fphone){
		  //保存手机号码
		  $.ajax({
			  url:BASE_PATH+'/lastHongbao/saveCompanyPhone.htm',
			  data:{"phone":$("input[name='phoneNumber']").val(),"maimai":$("input[name='mmtoken']").val()},
			  type:'post',
			  dataType:'json',
			  success:function(data){
                   if(data.success){
                       var companyContactPlace=$("input[name='companyContactPlace']").val();
                       var phoneNumber =$("input[name='phoneNumber']").val();
                       var mmtoken =$("input[name='mmtoken']").val();
                       window.location=BASE_PATH+"/lastHongbao/jumpToRegisterPage.htm?phoneNumber="+phoneNumber+"&companyContactPlace="+companyContactPlace+"&mmtoken="+mmtoken;
				   }else{
					   alert("未知错误");
				   }
			  },
			  error:function(){
				  alert("网络错误，请刷新页面")
			  }
		  })


		}
		
	});
    // 跳转到登录页
    $('.loginText').on('touchstart',function(){
        window.location.href=BASE_PATH+"/lastHongbao/jumpToLoginPage.htm";
    })
</script>
</html>